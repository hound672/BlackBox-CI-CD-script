openapi: 3.0.0
info:
  title: 'BlackBox CI/CD API v.1.0'
  description: BlackBox API spec
  version: 1.0.0-oas3
  contact:
    name: API Support
    email: vbliznetsov@ptsecurity.com
components:

  securitySchemes:
    apiToken:
      type: apiKey
      in: header
      name: basic
      description: basic {apiToken}

  requestBodies:
    apiProfileCreate:
      content:
        application/json:
          schema:
            type: object
            required:
              - groupUUID
              - name
              - apiSchemas
            properties:
              groupUUID:
                type: string
              name:
                type: string
              apiSchemas:
                type: array
                items:
                  $ref: '#/components/schemas/apiSchema'
    apiProfileUpdate:
      content:
        application/json:
          schema:
            type: object
            properties:
              name:
                type: string
              apiSchemas:
                type: array
                items:
                  $ref: '#/components/schemas/apiSchema'
    siteInputJSON:
      description: Only 'url' parameter is required
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              url:
                $ref: '#/components/schemas/XHRSiteURL'
              name:
                $ref: '#/components/schemas/XHRSiteName'
              verification:
                $ref: '#/components/schemas/XHRVerificationData'
              authenticationUUID:
                type: string
                description: Auth profile UUID
                example: 28b5a662-38a7-44f9-8119-ecd8d81ffa85
              profileUUID:
                type: string
                description: Scan profile UUID
                example: 28b5a662-38a7-44f9-8119-ecd8d81ffa85
              apiProfileUUID:
                type: string
                description: api profile UUID
                example: 241ab3ab-c56b-4aaf-9ff7-1714ed0e7e2b
              groupUUID:
                type: string
                description: group UUID
                example: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379
    siteSettingsInputJSON:
      description: Site settings set model
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              url:
                $ref: '#/components/schemas/XHRSiteURL'
              name:
                $ref: '#/components/schemas/XHRSiteName'
              verification:
                $ref: '#/components/schemas/XHRVerificationData'
              profileUUID:
                type: string
                description: scan profile UUID
                example: 28b5a662-38a7-44f9-8119-ecd8d81ffa85
              authenticationUUID:
                type: string
                description: authentication UUID
                example: 28b5a662-38a7-44f9-8119-ecd8d81ffa85
              apiProfileUUID:
                type: string
                description: api profile UUID
                example: 241ab3ab-c56b-4aaf-9ff7-1714ed0e7e2b
    sharedDataInputJSON:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              ttl:
                $ref: '#/components/schemas/sharedLinkTtlEnum'
              emails:
                description: List of emails that have permission for reading the scan report
                type: array
                nullable: true
                items:
                  type: string
                  example: john@example.com
    profileCreateJSON:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - baseProfileUUID
              - name
              - params
              - groupUUID
            properties:
              baseProfileUUID:
                type: string
                example: ca73e0f5-d286-457c-9ec2-deca88a38ec1
              name:
                type: string
                example: extended fast
              params:
                $ref: '#/components/schemas/XHRProfileCustomParams'
              groupUUID:
                type: string
                example: 77c71338-ff61-4112-b27d-cfecd2884fc7
    profileUpdateJSON:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              name:
                type: string
                example: extended fast
              params:
                $ref: '#/components/schemas/XHRProfileCustomParams'
    profileClone:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              groupUUID:
                type: string
                example: 77c71338-ff61-4112-b27d-cfecd2884fc7
    groupInput:
      required: true
      content:
        application/json:
          schema:
            type: object
            description: This object is used to create or update group info.
            properties:
              uuid:
                type: string
                example: e2ec6d75-127e-4511-a35f-0108a6b76b84
              name:
                type: string
                example: devops
    userRoleList:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - users
            properties:
              users:
                type: array
                description: This array is used to add users to group
                nullable: false
                required:
                  - uuid
                items:
                  $ref: '#/components/schemas/userRole'
    userInput:
      required: true
      content:
        application/json:
          schema:
            type: object
            description: This object is used to create or update group info.
            properties:
              uuid:
                type: string
                example: e2ec6d75-127e-4511-a35f-0108a6b76b84
    XHRAuthChainInput:
      required: true
      content:
        application/json:
          schema:
            type: object
            description: This object is used to create auth chain info.
            required:
              - name
              - profiles
            properties:
              name:
                type: string
                example: admin
              profiles:
                type: array
                items:
                  type: string
                example: [ "0d44db80-28fd-4dbc-8a3c-004071225d88", "78631129-2796-4e2b-97fc-b43909f02cd3", "fbf30a04-e549-4ae1-91f5-8f80b8f24eb4" ]
              groupUUID:
                type: string
                example: 77c71338-ff61-4112-b27d-cfecd2884fc7
    XHRAuthChainUpdate:
      required: true
      content:
        application/json:
          schema:
            type: object
            description: This object is used to update auth chain info.
            required:
              - name
              - profiles
            properties:
              name:
                type: string
                example: admin
              profiles:
                type: array
                items:
                  type: string
                example: [ "0d44db80-28fd-4dbc-8a3c-004071225d88", "78631129-2796-4e2b-97fc-b43909f02cd3", "fbf30a04-e549-4ae1-91f5-8f80b8f24eb4" ]
    XHRAuthProfileInput:
      required: true
      content:
        application/json:
          schema:
            type: object
            description: This object is used to create auth profile info.
            required:
              - name
              - type
            properties:
              name:
                type: string
                example: admin
              type:
                $ref: '#/components/schemas/targetAuthenticationTypesEnum'
              httpBasic:
                $ref: '#/components/schemas/XHRTargetAuthHTTPBasic'
              htmlAutoForm:
                $ref: '#/components/schemas/XHRTargetAuthHTMLAutoForm'
              htmlFormBased:
                $ref: '#/components/schemas/XHRTargetAuthHTMLFormBased'
              rawCookie:
                $ref: '#/components/schemas/XHRTargetAuthRawCookie'
              apiKey:
                $ref: '#/components/schemas/XHRTargetAuthAPIKey'
              bearer:
                $ref: '#/components/schemas/XHRTargetAuthBearer'
              groupUUID:
                type: string
          examples:
            http_basic:
              value:
                name: admin
                type: HTTP_BASIC
                httpBasic: {
                  username: admin,
                  password: P@ssw0rd
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            html_auto_form:
              value:
                name: admin
                type: HTML_AUTO_FORM
                htmlAutoForm: {
                  username: admin,
                  password: P@ssword,
                  formUrl: 'https://itsm.example.com/login/',
                  successString: My profile
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            html_form_based:
              value:
                name: admin
                type: HTML_FORM_BASED
                htmlFormBased: {
                  formUrl: 'https://itsm.example.com/login/',
                  formXPath: .//form,
                  usernameField: login,
                  usernameValue: admin,
                  passwordField: pass,
                  passwordValue: P@ssw0rd,
                  regexpOfSuccess: Welcome to Damn Vulnerable Web Application!,
                  submitValue: Log in
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            raw_cookie:
              value:
                name: admin
                type: RAW_COOKIE
                rawCookie: {
                  cookies: [ PHPSESSID=bnc3li5jhmebd50suf9a99u0u3; ],
                  successUrl: 'http://mydvwa.ru/vulnerabilities/xss_r/',
                  regexpOfSuccess: Logout
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            api_key_COOKIE:
              value:
                name: admin
                type: API_KEY
                apiKey: {
                  place: COOKIE,
                  name: X-Some-Header,
                  value: some-token-value,
                  successUrl: 'http://api.example.test:8000/auth/check',
                  successString: Access granted
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            api_key_HEADER:
              value:
                name: admin
                type: API_KEY
                apiKey: {
                  place: HEADER,
                  name: X-Some-Header,
                  value: some-token-value,
                  successUrl: 'http://api.example.test:8000/auth/check',
                  successString: Access granted
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            api_key_QUERY:
              value:
                name: admin
                type: API_KEY
                apiKey: {
                  place: QUERY,
                  name: X-Some-Header,
                  value: some-token-value,
                  successUrl: 'http://api.example.test:8000/auth/check',
                  successString: Access granted
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
            bearer:
              value:
                name: admin
                type: BEARER
                bearer: {
                  token: some-token-value,
                  successUrl: 'http://api.example.test:8000/auth/check',
                  successString: Access granted
                }
                groupUUID: 77c71338-ff61-4112-b27d-cfecd2884fc7
    XHRAuthProfileUpdate:
      required: true
      content:
        application/json:
          schema:
            type: object
            description: This object is used to update auth profile info.
            required:
              - name
              - type
            properties:
              name:
                type: string
                example: admin
              type:
                $ref: '#/components/schemas/targetAuthenticationTypesEnum'
              httpBasic:
                $ref: '#/components/schemas/XHRTargetAuthHTTPBasic'
              htmlAutoForm:
                $ref: '#/components/schemas/XHRTargetAuthHTMLAutoForm'
              htmlFormBased:
                $ref: '#/components/schemas/XHRTargetAuthHTMLFormBased'
              rawCookie:
                $ref: '#/components/schemas/XHRTargetAuthRawCookie'
              apiKey:
                $ref: '#/components/schemas/XHRTargetAuthAPIKey'
              bearer:
                $ref: '#/components/schemas/XHRTargetAuthBearer'
          examples:
            http_basic:
              value:
                name: admin
                type: HTTP_BASIC
                httpBasic: {
                  username: admin,
                  password: P@ssw0rd
                }
            html_auto_form:
              value:
                name: admin
                type: HTML_AUTO_FORM
                htmlAutoForm: {
                  username: admin,
                  password: P@ssword,
                  formUrl: 'https://itsm.example.com/login/',
                  successString: My profile
                }
            html_form_based:
              value:
                name: admin
                type: HTML_FORM_BASED
                htmlFormBased: {
                  formUrl: 'https://itsm.example.com/login/',
                  formXPath: .//form,
                  usernameField: login,
                  usernameValue: admin,
                  passwordField: pass,
                  passwordValue: P@ssw0rd,
                  regexpOfSuccess: Welcome to Damn Vulnerable Web Application!,
                  submitValue: Log in
                }
            raw_cookie:
              value:
                name: admin
                type: RAW_COOKIE
                rawCookie: {
                  cookies: [ PHPSESSID=bnc3li5jhmebd50suf9a99u0u3; ],
                  successUrl: 'http://mydvwa.ru/vulnerabilities/xss_r/',
                  regexpOfSuccess: Logout
                }
            api_key:
              value:
                name: admin
                type: API_KEY
                apiKey: {
                  place: HEADER,
                  name: X-Some-Header,
                  value: some-token-value,
                  successUrl: 'http://api.example.test:8000/auth/check',
                  successString: Access granted
                }
            bearer:
              value:
                name: admin
                type: BEARER
                bearer: {
                  token: some-token-value,
                  successUrl: 'http://api.example.test:8000/auth/check',
                  successString: Access granted
                }
  parameters:
    apiProfileUUID:
      in: path
      name: apiprofileUUID
      schema:
        type: string
      required: true
      description: UUID of API Profile
    siteUUID:
      in: path
      name: siteUUID
      schema:
        type: string
      required: true
      description: site's UUID
    scanID:
      in: path
      name: scanID
      schema:
        type: integer
      required: true
      description: Numerical ID of user's scan for previously specified site
    issueTypes:
      in: path
      name: issueTypes
      required: true
      schema:
        type: string
        enum:
        - issue
        - cve
        - error_page
    profileUUID:
      in: path
      name: profileUUID
      schema:
        type: string
      required: true
      description: UUID of profile
    authChainUUID:
      in: path
      name: authChainUUID
      schema:
        type: string
      required: true
      example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
      description: UUID of auth chain
    authProfileUUID:
      in: path
      name: authProfileUUID
      schema:
        type: string
      required: true
      example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
      description: UUID of auth profile
    groupName:
      in: path
      name: groupName
      required: true
      schema:
        type: string
    severity:
      in: path
      name: severity
      required: true
      schema:
        type: string
        enum:
          - HIGH
          - MEDIUM
          - LOW
          - INFO
    csrfToken:
      in: header
      name: X-CSRFToken
      schema:
        type: string
        example: Mn1ws1YUnOG6FFQsmzyuRGwm4HuXY6yAYNaWzh9YhvMR9jrTGHcsQbF4h2RPVIaq
      description: Value of 'csrf_token' cookie
      required: true
    paginationLimit:
      in: query
      name: limit
      schema:
        type: integer
      required: false
      description: The numbers of items to return
      example: 10
    paginationPage:
      in: query
      name: page
      schema:
        type: integer
      required: false
      description: The number of current page
      example: 1
    filterByName:
      in: query
      name: name
      schema:
        type: string
      required: false
      description: Filter groups by name
      example: test_group
    filterByRole:
      in: query
      name: role
      schema:
        type: string
      required: false
      description: Filter groups by role
      example: admin
    groupUUID:
      in: path
      name: groupUUID
      schema:
        type: string
      required: true
      example: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379
      description: group UUID

  schemas:
    apiProfileLoginRequired:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: HTTP_ERROR_401
                description:
                  example: Login required
    apiProfileNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: API_PROFILE_NOT_FOUND
                description:
                  example: api profile not found

    apiProfileIsUsed:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: API_PROFILE_IS_USED
                details:
                  type: object
                  properties:
                    sites:
                      type: array
                      items:
                        type: id
                        description: List of sites' id for current profile
                      example:
                        - 1
                        - 2
    apiProfileInvalidEncoder:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: INVALID_ENCODER
                description:
                  example: invalid encoder
    apiProfileInvalidContent:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: INVALID_CONTENT
                description:
                  example: invalid content
    apiProfileInvalidSchema:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: INVALID_SCHEMA_TYPE
                description:
                  example: invalid schema type
    apiProfile:
      type: object
      description: This object represents an APIProfile
      required:
        - uuid
        - name
        - apiSchemas
        - createdAt
        - group
      properties:
        uuid:
          type: string
          nullable: false
          description: UUID of APIProfile
        name:
          type: string
          nullable: false
          description: Name of APIProfile
        createdAt:
          type: string
          nullable: false
          description: datetime in ISO format
        apiSchemas:
          type: array
          items:
            $ref: '#/components/schemas/apiSchema'
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    apiProfileShort:
      type: object
      description: This object represents an APIProfile short info
      required:
        - uuid
        - name
        - countOfSchemas
      properties:
        uuid:
          type: string
          description: UUID of APIProfile
          example: 23914922-5e78-42ad-8837-1ca312094a7f
        name:
          type: string
          description: Name of APIProfile
          example: API Profile
        countOfSchemas:
          type: integer
          description: Count of schemas
          example: 2
    apiProfileShortInfo:
      type: object
      description: This object represents an APIProfile short info
      required:
        - uuid
        - name
        - countOfSchemas
        - group
      properties:
        uuid:
          type: string
          description: UUID of APIProfile
        name:
          type: string
          description: Name of APIProfile
        countOfSchemas:
          type: integer
          description: Count of schemas
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    apiProfilesCreated:
      type: object
      description: This object represents an APIProfile created info
      required:
        - uuid
        - name
        - countOfSchemas
        - group
      properties:
        uuid:
          type: string
          description: UUID of APIProfile
        name:
          type: string
          description: Name of APIProfile
        countOfSchemas:
          type: integer
          description: Count of schemas
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    apiSchema:
      type: object
      description: This object represents an APISchema which is part of APIProfile
      required:
        - type
        - content
      properties:
        type:
          type: string
          enum:
            - openapi
          nullable: false
        content:
          type: object
          required:
            - type
            - data
          properties:
            type:
              type: string
              enum:
                - application/json
                - application/x-yaml
                - link
              nullable: false
            data:
              type: string
              nullable: false
        openapi:
          nullable: false
          $ref: '#/components/schemas/openAPIOptions'
    openAPIOptions:
      type: object
      description: This object represents an options for APISchema
      properties:
        prefix:
          type: string
          nullable: false
    baseResponse:
      type: object
      description: Base response for any request
      required:
        - ok
      properties:
        ok:
          type: boolean
          description: Indicates whether request was successful
          example: true
    errorResponse:
      allOf:
        - $ref: '#/components/schemas/baseResponse'
        - type: object
          description: Error occurred during processing of the request
          required:
            - error
            - ok
          properties:
            ok:
              example: false
            error:
              type: object
              required:
                - code
                - description
              properties:
                code:
                  type: string
                  description: 'Unique error code, for developers and debugging'
                  example: UNAUTHORIZED
                description:
                  type: string
                  description: Human-readable description of error
                  example: The request has not been applied because it lacks valid authentication credentials for the target resource.
                details:
                  type: object
                  description: Error-specific technical details
    siteNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: SITE_NOT_FOUND
                description:
                  example: The site not found
    scanNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: SCAN_NOT_FOUND
    scanCreateLastScanProgress:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - description
              properties:
                description:
                  example: Can't start new scan, previous scan is not finished yet
    scanAuthCheckInProgress:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - description
              properties:
                description:
                  example: Can't start scan because authentication check has not finished yet
    scanStartTaskSend:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
                - description
              properties:
                code:
                  example: SCAN_START_ERROR
                description:
                  example: Cannot send task start scan
    scanStopTaskSend:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
                - description
              properties:
                code:
                  example: SCAN_STOP_ERROR
                description:
                  example: Cannot send task stop scan
    sitePermissionDenied:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PERMISSION_DENIED
                description:
                  example: You have no permission to make this action with site
                details:
                  type: object
                  properties:
                    permissions:
                      type: string
                      example: CAN_EDIT_SITE_INFO
    siteLimitExceeded:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: LIMIT_EXCEEDED
                details:
                  $ref: '#/components/schemas/roleAttributeDescription'
    siteExist:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: SITE_EXIST_ERROR
    siteCannotSetUrl:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - description
              properties:
                description:
                  example: Url can't be changed after first scan
    siteCannotSetAuth:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
                - description
              properties:
                code:
                  example: SITE_CANNOT_SET_AUTH
                description:
                  example: Authentication cannot be set up while a scan or auth check is in progress
    scanCannotBeStopped:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - description
              properties:
                description:
                  example: Scan can be stopped only after start
    urlError:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
                - description
              properties:
                code:
                  example: URL_ERROR
                description:
                  type: string
                  example: Invalid url was passed
    siteUrlDeniedForAnyScans:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
                - description
              properties:
                code:
                  example: URL_DENIED_FOR_SCAN
                description:
                  type: string
                  example: This url is denied for all scan types
    licenseLimitExceeded:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: LICENSE_LIMIT_EXCEEDED
                details:
                  $ref: '#/components/schemas/roleAttributeDescription'
    profileLoginRequired:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: HTTP_ERROR_401
                description:
                  example: Login required
    profileNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PROFILE_NOT_FOUND
    profileCannotBeModified:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PROFILE_CANNOT_BE_MODIFIED
    profileCannotBeDeleted:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PROFILE_CANNOT_BE_DELETED
    profileIsBusy:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PROFILE_IS_USED
                details:
                  type: object
                  properties:
                    sites:
                      type: array
                      items:
                        type: id
                        description: List of sites' id for current profile
                      example:
                        - 1
                        - 2
    profileInvalidModules:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: INVALID_MODULES
                details:
                  type: object
                  properties:
                    invalidModules:
                      type: array
                      items:
                        type: string
                        description: List of modules names
                      example:
                        - bitrix
                        - csrf
    profileInvalidBase:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: INVALID_BASE_PROFILE
    apiProfilePermissionDenied:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PERMISSION_DENIED
                description:
                  example: 'You have no permission to make this action with api-profile'
                details:
                  type: object
                  properties:
                    permissions:
                      type: string
                      example: CAN_EDIT_APIPROFILE_INFO
    licenseInvalid:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: LICENSE_ERROR
    fetchLicense:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: FETCH_LICENSE_ERROR
    siteAuthSettingsNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
                - description
              properties:
                code:
                  example: SITE_AUTHENTICATION_NOT_FOUND
                description:
                  type: string
                  example: Site authentication is not found
    authProfileIsUsed:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: AUTH_PROFILE_IS_USED
                details:
                  type: object
                  properties:
                    sites:
                      type: array
                      items:
                        type: id
                        description: List of sites' id for current profile
                      example:
                        - 1
                        - 2
                    authChains:
                      type: array
                      items:
                        type: string
                        description: List of auth chains' uuid current profile
                      uniqueItems: true
                      example:
                        - 8cd8ba0f-9c90-410f-87d2-1a63d4ebda1d
                        - f2ebde0b-ab3b-4eff-ba54-c8ce073dfe5e

    authChainIsUsed:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: AUTH_CHAIN_IS_USED
                details:
                  type: object
                  properties:
                    sites:
                      type: array
                      items:
                        type: id
                        description: List of sites' id for current profile
                      example:
                        - 1
                        - 2

    authChainLoginRequired:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: HTTP_ERROR_401
                description:
                  example: Login required
    authChainAuthProfilesNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: AUTH_PROFILES_NOT_FOUND
                details:
                  example: { 'UUIDs': [ '78631129-2796-4e2b-97fc-b43909f02cd3', 'fbf30a04-e549-4ae1-91f5-8f80b8f24eb4' ] }
    authProfileInvalidAuthentication:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: AUTH_PROFILE_INVALID_AUTHENTICATION
                description:
                  example: Authentication Profile invalid authentication data
    authChainNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: AUTH_CHAIN_NOT_FOUND
    authProfileLoginRequired:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: HTTP_ERROR_401
                description:
                  example: Login required
    authProfileNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: AUTH_PROFILE_NOT_FOUND
    groupNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              required:
                - code
              properties:
                code:
                  example: GROUP_NOT_FOUND_ERROR
    loginRequired:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: HTTP_ERROR_401
                description:
                  example: Login required
    permissionDenied:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PERMISSION_DENIED
                description:
                  example: You have no permission to make this action
                details:
                  type: object
                  properties:
                    permissions:
                      type: string
                      example: CAN_EDIT_GROUP_INFO
    roleAttributeDescription:
      type: object
      properties:
        limits:
          type: string
        permissions:
          type: string
    verificationTypesEnum:
      type: string
      nullable: false
      description: Current verification type selected by user for specified site
      enum:
        - HTML_FILE
        - AGENT
      example: HTML_FILE
    ErrorReasonEnum:
      type: string
      nullable: true
      description: List of all possible scan errors
      enum:
        - API_SCHEMA_ERROR
        - TARGET_CONNECT_FAILED
        - TARGET_CONNECTION_TIMED_OUT
        - TARGET_PAGE_IS_STATIC
        - TARGET_DOWNLOAD_LIMIT_EXCEEDED
        - AGENT_IS_UNAVAILABLE
        - TARGET_REDIRECT_LIMIT
        - TARGET_DNS_RESOLUTION_FAILED
        - TARGET_HTTP_ERROR_404
        - TARGET_HTTP_ERROR_500
        - UNREACHABLE_REDIRECT
        - AUTH_CHECK_FAILED
        - UNKNOWN_ERROR
      example: null
    ScanStatusEnum:
      type: string
      nullable: false
      description: List of all possible scan states
      enum:
        - CREATED
        - SENT_START_TASK
        - STARTED
        - SENT_STOP_TASK
        - STOPPED
        - FINISHED
      example: FINISHED
    SeverityTypeEnum:
      type: string
      nullable: false
      description: List of all severity types
      enum:
        - HIGH
        - MEDIUM
        - LOW
        - INFO
      example: HIGH
    VulnChannelsEnum:
      type: string
      nullable: false
      description: Possible vulnerability channels
      enum:
        - PARAM
        - HEADER
        - URL_PATH
        - URL_QUERY
        - COOKIE
        - COMBO
      example: PARAM
    HTTPVerbsEnum:
      type: string
      nullable: false
      description: List of commonly used HTTP methods
      enum:
        - GET
        - POST
        - PUT
        - PATCH
        - DELETE
        - HEAD
        - OPTIONS
      example: POST
    AgentStatusEnum:
      type: string
      nullable: false
      description: List of all possible agent states
      enum:
        - ACTIVE
        - INACTIVE
        - DELETED
      example: ACTIVE
    AuthStatusEnum:
      type: string
      nullable: false
      description: List of possible authentication statuses
      enum:
        - NOT_CHECKED
        - CHECKING
        - SUCCESS
        - FAILED
    XHRSiteName:
      type: string
      nullable: true
      description: User-defined name of the site
      minLength: 1
      maxLength: 50
      example: Company ITSM portal
    XHRSiteURL:
      type: string
      description: URL of target site
      maxLength: 255
      example: 'https://itsm.example.com/'
    XHRSiteShort:
      type: object
      description: This object represents user's site
      properties:
        id:
          type: integer
          description: Unique ID of site (user scope)
          nullable: false
          example: 2
        verified:
          type: boolean
          nullable: false
          example: true
        name:
          type: string
          nullable: true
          description: User-defined name of site
          example: Company ITSM portal
        url:
          type: string
          nullable: false
          description: Target site URL. This is an entry point for all subsequent scans.
          example: 'https://itsm.example.com/'
        createdAt:
          type: string
          format: date-time
        lastScan:
          $ref: '#/components/schemas/XHRScanShort'
        profile:
          $ref: '#/components/schemas/XHRProfileShort'
        authentication:
          $ref: '#/components/schemas/XHRSiteAuthentication'
        apiProfile:
          $ref: '#/components/schemas/apiProfileShort'
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    XHRSiteInfo:
      type: object
      description: This object represents user's site
      properties:
        uuid:
          type: string
          description: Unique UUID of site
          nullable: false
          example: 6ae38ae8-8c20-4b79-a7ca-b11a90121f80
        verified:
          type: boolean
          nullable: false
          example: true
        name:
          type: string
          nullable: true
          description: User-defined name of site
          example: Company ITSM portal
        url:
          type: string
          nullable: false
          description: Target site URL. This is an entry point for all subsequent scans.
          example: 'https://itsm.example.com/'
        agent:
          nullable: true
          allOf:
            - $ref: '#/components/schemas/XHRAgent'
        createdAt:
          type: string
          format: date-time
        lastScan:
          $ref: '#/components/schemas/XHRScanShort'
        requestFullScanStatus:
          type: string
          description: Contains request full scan status (field will be omitted on OnPremise)
          enum:
            - PENDING
            - ACCEPTED
            - REJECTED
        profile:
          $ref: '#/components/schemas/XHRProfileShort'
        authentication:
          $ref: '#/components/schemas/XHRSiteAuthentication'
        authStatus:
          $ref: '#/components/schemas/AuthStatusEnum'
        apiProfile:
          $ref: '#/components/schemas/apiProfileShort'
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    XHRVerificationData:
      type: object
      description: Data for site ownership verification
      properties:
        type:
          $ref: '#/components/schemas/verificationTypesEnum'
        htmlFile:
          type: object
          description: Data for HTML file verification type
          nullable: true
          properties:
            fileName:
              type: string
              description: Name of HTML verification file
              nullable: false
              example: 2f5efac781d59c86a5637dcaed73745a2c362c227fdf264ea1db5a58b1da39a6.html
            key:
              type: string
              description: Key stored in verification file
              nullable: false
              example: f85a3e4d99046f905687a076fa1b547b07268f81dedde930637a9b31e839fe23
        agent:
          type: object
          description: Data for agent verification type
          nullable: true
          properties:
            id:
              type: integer
              nullable: false
              description: ID of existing agent to use
              example: 2
    XHRSiteSettings:
      type: object
      description: This object represents current site settings
      properties:
        name:
          type: string
          description: User-defined name for site
          nullable: false
          example: Company ITSM portal
        url:
          type: string
          description: Target URL for scanning
          example: 'https://itsm.example.com/'
        verification:
          $ref: '#/components/schemas/XHRVerificationData'
        profile:
          $ref: '#/components/schemas/XHRProfileShort'
        authentication:
          $ref: '#/components/schemas/XHRSiteAuthentication'
        apiProfile:
          $ref: '#/components/schemas/apiProfileShort'
    XHRProfileShort:
      type: object
      description: This object represents a shoft profile custom params info
      required:
        - uuid
        - name
        - type
        - group
      properties:
        uuid:
          type: string
          example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
        name:
          type: string
          example: extended fast
        type:
          type: string
          enum:
            - FULL
            - OPTIMAL
            - CUSTOM
          example: FULL
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    profilesCreated:
      type: object
      description: This object represents a short profile custom params info
      required:
        - uuid
        - name
        - type
      properties:
        uuid:
          type: string
          example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
        name:
          type: string
          example: extended fast
        type:
          type: string
          enum:
            - FULL
            - OPTIMAL
            - CUSTOM
          example: FULL
    groupPermissionDenied:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: PERMISSION_DENIED
                description:
                  example: You have no permission to make this action with group
                details:
                  type: object
                  properties:
                    permissions:
                      type: string
                      example: CAN_EDIT_GROUP_INFO
    XHRSiteAuthentication:
      type: object
      description: This object represents an authentication info for site
      required:
        - uuid
        - name
        - type
      properties:
        uuid:
          type: string
          example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
        name:
          type: string
          example: admin
        type:
          $ref: '#/components/schemas/authProfileTypesEnum'
    ScanIntegralScore:
      type: integer
      description: Scan's integral score
      example: 6
      minimum: 1
      maximum: 10
    XHRGroupShortInfo:
      type: object
      description: This object represents a short group info
      required:
        - uuid
        - name
      properties:
        uuid:
          type: string
          example: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379
        name:
          type: string
          example: devops
    authProfileTypesEnum:
      type: string
      enum:
        - USER
        - CHAIN
      example: USER
    XHRVulnChannel:
      type: object
      nullable: true
      description: Optional information about channel of injection
      properties:
        httpVerb:
          $ref: '#/components/schemas/HTTPVerbsEnum'
        type:
          $ref: '#/components/schemas/VulnChannelsEnum'
        parameterName:
          type: string
          nullable: false
          description: Parameter name
          example: id
    XHRScanShort:
      type: object
      description: This object represents a single scan
      properties:
        id:
          type: integer
          nullable: false
          example: 3
        authStatus:
          type: string
          description: Authentication status for scan
          enum:
            - NOT_CHECKED
            - CHECKING
            - SUCCESS
            - FAILED
        startedAt:
          type: string
          format: date-time
          description: Date-time when BBS actually started to scan specified target
        finishedAt:
          type: string
          format: date-time
        status:
          $ref: '#/components/schemas/ScanStatusEnum'
        errorReason:
          $ref: '#/components/schemas/ErrorReasonEnum'
        progress:
          type: integer
          nullable: true
          example: 82
        vulnStats:
          $ref: '#/components/schemas/VulnerabilityStats'
        queuePosition:
          type: integer
          nullable: true
          example: 2
        score:
          $ref: '#/components/schemas/ScanIntegralScore'
        profile:
          $ref: '#/components/schemas/XHRProfileShort'
        authentication:
          $ref: '#/components/schemas/XHRSiteAuthentication'

    XHRVulnerabilityGroup:
      type: object
      description: This object represents a single found grouped vulnerability
      properties:
        issueType:
          $ref: '#/components/schemas/VulnerabilityIssueTypeEnum'
        categoryLocaleKey:
          type: string
          nullable: false
          description: Contains reference to current vuln category
          example: sensitive_data
        count:
          type: integer
          nullable: false
          description: Contains vulns count in current group
          example: 5
        groupTitle:
          type: string
          nullable: false
          description: Contains title for current group
          example: disclosure_email
        requestKey:
          type: string
          nullable: true
          description: Contains part of url for requesting all vulns in current group
          example: disclosure_email
        severity:
          $ref: '#/components/schemas/SeverityTypeEnum'
        vulnerability:
          type: object
          anyOf:
            - $ref: '#/components/schemas/XHRVulnerabilityIssueType'
            - $ref: '#/components/schemas/XHRVulnerabilityCVEType'
            - $ref: '#/components/schemas/XHRVulnerabilityCVEApprovedType'
            - $ref: '#/components/schemas/XHRVulnerabilityErrorPageType'
            - $ref: '#/components/schemas/XHRVulnerabilityAppsType'
    XHRAgent:
      type: object
      description: Agent entitiy for /agents
      properties:
        id:
          type: integer
          description: Unique agent id (user scope)
          example: 4
        name:
          type: string
          description: User-defined name of current agent
          example: Virtual linux machine in DMZ
        status:
          $ref: '#/components/schemas/AgentStatusEnum'
        createdAt:
          nullable: true
          type: string
          format: date-time
          description: Date-time of agent activation
        connectedAt:
          nullable: true
          type: string
          format: date-time
          description: Datetime of last agent connect action
        disconnectedAt:
          nullable: true
          type: string
          format: date-time
          description: Datetime of last agent disconnect action
    VulnerabilityStats:
      type: object
      properties:
        high:
          $ref: '#/components/schemas/VulnerabilityStatsItem'
        medium:
          $ref: '#/components/schemas/VulnerabilityStatsItem'
        low:
          $ref: '#/components/schemas/VulnerabilityStatsItem'
        info:
          $ref: '#/components/schemas/VulnerabilityStatsItem'
    VulnerabilityStatsItem:
      type: object
      properties:
        real:
          type: integer
          example: 2
        fixed:
          type: integer
          example: 1
    XHRMatchesArray:
      type: object
      description: 'An array of found objects, which are usually relate to Information Exposure'
      properties:
        foundData:
          type: array
          items:
            type: string
            example: 192.168.154.1
    XHRVulnerabilityIssueType:
      type: object
      description: This object represents a class of known vulnerabilities
      properties:
        id:
          type: integer
          nullable: false
          description: Vuln's id
          example: 2
        urlRel:
          type: string
          nullable: false
          description: Relative URL where vulnerability was found
          example: /ticket/create
        urlFull:
          type: string
          nullable: false
          description: Full URL where vulnerability was found
          example: 'https://itsm.example.com/ticket/create'
        channel:
          $ref: '#/components/schemas/XHRVulnChannel'
        requestRaw:
          type: string
          nullable: true
          description: Raw HTTP request
          example: |-
            POST /ticket/create HTTP/1.1
            Host: itsm.example.com
            content-type: application/x-www-form-urlencoded
            content-length: 66

            subject=%3C/textarea%3E%3Cscript%3Econfirm%2820836%29%3C/script%3E
        responseRaw:
          type: string
          nullable: true
          description: Raw HTTP response
          example: |-
            HTTP/1.1 200 OK
            Content-Length: 89
            Content-Type: text/html; charset=UTF-8

            <!DOCTYPE html><html><body><p>Invalid subject: </textarea><script>confirm(20836)</script>
        responseTime:
          type: number
          nullable: true
          description: Execution time in seconds
          example: 1.123
        matches:
          $ref: '#/components/schemas/XHRMatchesArray'
        vector:
          type: string
          nullable: true
          description: Optional string containing attack vector
          example: </textarea><script>confirm(20836)</script>
        severity:
          $ref: '#/components/schemas/SeverityTypeEnum'
        createdAt:
          type: string
          format: date-time
          description: Vulnerability detection Date-time

    XHRVulnerabilityCVEType:
      type: object
      description: This object represents a class of known vulnerabilities
      properties:
        id:
          type: integer
          nullable: false
          description: Vuln's id
          example: 2
        cveId:
          type: string
          nullable: false
          description: CVE Unique number
          example: CVE-2015-6665
        title:
          type: string
          nullable: false
          description: CVE's title
          example: CVE-2015-6665
        cvss:
          type: number
          nullable: false
          description: cvss value
          example: 3.5
        vector:
          type: string
          nullable: false
          description: cve vector
          example: '(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)'
    XHRVulnerabilityCVEApprovedType:
      type: object
      description: This object represents a class of known vulnerabilities
      properties:
        cveId:
          type: string
          nullable: false
          description: CVE Unique number
          example: CVE-2015-6665
        title:
          type: string
          nullable: false
          description: CVE's title
          example: CVE-2015-6665
        cvss:
          type: number
          nullable: false
          description: cvss value
          example: 3.5
        cvssVector:
          type: string
          nullable: false
          description: cve vector
          example: '(AV:N/AC:M/Au:N/C:N/I:P/A:N/E:U/RL:OF/RC:C)'
        requestRaw:
          type: string
          nullable: true
          description: Raw HTTP request
          example: HTTP/1.1 200 OK\r\n...</html>\n\n
        responseRaw:
          type: string
          nullable: true
          description: Raw HTTP response
          example: GET / HTTP/1.1\r\n...
        matches:
          type: array
          items:
            type: string
            example: Apache/2.4.43
    XHRVulnerabilityErrorPageType:
      type: object
      description: This object represents a class of known vulnerabilities
      properties:
        id:
          type: integer
          nullable: false
          description: Vuln's id
          example: 2
        code:
          type: integer
          nullable: false
          description: Page's status code
          example: 404
        url:
          type: string
          nullable: false
          description: Relative URL where vulnerability was found
          example: /ticket/create
        request:
          type: string
          nullable: true
          description: Raw HTTP request
          example: |-
            POST /ticket/create HTTP/1.1
            Host: itsm.example.com
            content-type: application/x-www-form-urlencoded
            content-length: 66

            subject=%3C/textarea%3E%3Cscript%3Econfirm%2820836%29%3C/script%3E
        response:
          type: string
          nullable: true
          description: Raw HTTP response
          example: |-
            HTTP/1.1 200 OK
            Content-Length: 89
            Content-Type: text/html; charset=UTF-8

            <!DOCTYPE html><html><body><p>Invalid subject: </textarea><script>confirm(20836)</script>

    XHRVulnerabilityAppsType:
      type: object
      description: This object represents a class of known vulnerabilities
      properties:
        apps:
          type: array
          items:
            $ref: '#/components/schemas/XHRVulnerabilityApp'

    XHRVulnerabilityApp:
      type: object
      properties:
        name:
          type: string
          nullable: false
          description: App's name
        version:
          type: string
          nullable: false
          description: App's version
        type:
          type: string
          nullable: false
          description: App's type

    XHRPagination:
      type: object
      properties:
        totalItems:
          type: integer
          nullable: false
          description: All items count
          example: 500
        hasPrevPage:
          type: boolean
          nullable: false
          description: If there is a previous page
          example: false
        hasNextPage:
          type: boolean
          nullable: false
          description: If there is a next page
          example: false
        pagesCount:
          type: integer
          nullable: false
          description: All pages count
          example: 1
        currentPage:
          type: integer
          nullable: false
          description: Current page number
          example: 1
    sharedLinkTtlEnum:
      type: integer
      nullable: true
      description: Shared link's time to live (in hours)
      enum:
        - 3
        - 24
        - 168
        - 720
        - 4320
      example: 24
    groupTypesEnum:
      type: string
      enum:
        - PRODUCT
        - USER
      example: USER
    roleNameConstantsEnum:
      type: string
      description: PT BlackBox roles
        - BASIC_API_TOKEN
        - GUEST
        - BASIC_UNVERIFIED_USER
        - BASIC_VERIFIED_USER
        - AUDITOR
        - OPERATOR
        - MODERATOR
        - MANAGER
        - ADMIN
      example: OPERATOR
    SharedLinkCreated:
      type: object
      description: This object represents a shared link created info
      properties:
        uuid:
          type: string
          nullable: false
          description: Sharer link's UUID
        ttl:
          $ref: '#/components/schemas/sharedLinkTtlEnum'
        emails:
          description: List of emails that has permission for reading the scan report
          type: array
          nullable: true
          items:
            type: string
            example: john@example.com
    VulnerabilityIssueTypeEnum:
      type: string
      nullable: false
      description: Vulnerability type
      enum:
        - issue
        - cve
        - error_page
        - apps
    apiKeyTypesEnum:
      type: string
      enum:
        - COOKIE
        - HEADER
        - QUERY
    targetAuthenticationTypesEnum:
      type: string
      nullable: false
      description: Current authentication type selected by user for specified target
      enum:
        - HTTP_BASIC
        - HTML_AUTO_FORM
        - HTML_FORM_BASED
        - RAW_COOKIE
        - API_KEY
        - BEARER
      example: HTML_FORM_BASED
    XHRTargetAuthHTTPBasic:
      type: object
      description: Parameters for HTTP basic authentication
      required:
        - username
        - password
      additionalProperties: false
      properties:
        username:
          type: string
          description: Username for HTTP authentication
          minLength: 1
          example: admin
        password:
          type: string
          description: Password for HTTP authentication
          minLength: 1
          example: P@ssw0rd
    XHRTargetAuthHTMLAutoForm:
      type: object
      description: Parameters for HTML autoform authentication
      required:
        - username
        - password
        - formUrl
        - successString
      additionalProperties: false
      properties:
        username:
          type: string
          minLength: 1
          description: Username for autoform authentication
          example: admin
        password:
          type: string
          minLength: 1
          description: Password for autoform authentication
          example: P@ssw0rd
        formUrl:
          type: string
          minLength: 5
          description: Form location URL
          example: 'https://itsm.example.com/login/'
        successString:
          type: string
          minLength: 3
          description: String on target page to check if target authentication was successful
          example: My profile
    XHRTargetAuthHTMLFormBased:
      type: object
      description: Parameters for HTML form-based authentication
      required:
        - formUrl
        - formXPath
        - usernameField
        - usernameValue
        - passwordField
        - passwordValue
        - regexpOfSuccess
      additionalProperties: false
      properties:
        formUrl:
          type: string
          minLength: 5
          description: Form location URL
          example: 'https://itsm.example.com/login/'
        formXPath:
          type: string
          minLength: 1
          description: Form location XPath
          example: './/form'
        usernameField:
          type: string
          minLength: 1
          description: Username form field name for form-based authentication
          example: login
        usernameValue:
          type: string
          minLength: 1
          description: Username for form-based authentication
          example: admin
        passwordField:
          type: string
          minLength: 1
          description: Password form field name for form-based authentication
          example: pass
        passwordValue:
          type: string
          minLength: 1
          description: Password for form-based authentication
          example: P@ssw0rd
        regexpOfSuccess:
          type: string
          minLength: 3
          description: Regexp to locate string on target page to check if authentication was successful
          example: 'Welcome to Damn Vulnerable Web Application!'
        submitValue:
          type: string
          minLength: 1
          description: Submit form button value
          example: 'Log in'
    XHRTargetAuthRawCookie:
      type: object
      description: Parameters for raw cookie authentication
      required:
        - cookies
        - successUrl
        - regexpOfSuccess
      additionalProperties: false
      properties:
        cookies:
          type: array
          minLength: 1
          description: Raw cookies list
          nullable: true
          items:
            type: string
            minLength: 1
            example: 'PHPSESSID=bnc3li5jhmebd50suf9a99u0u3;'
        successUrl:
          type: string
          minLength: 5
          description: Address where success string will be located in case of success authentication
          example: 'http://mydvwa.ru/vulnerabilities/xss_r/'
        regexpOfSuccess:
          type: string
          minLength: 3
          description: Regexp to locate string on target page to check if target authentication was successful
          example: 'Logout'
    XHRTargetAuthAPIKey:
      type: object
      description: parameters for api key authentication
      required:
        - type
        - name
        - value
        - successUrl
      properties:
        place:
          $ref: '#/components/schemas/apiKeyTypesEnum'
        name:
          type: string
          minLength: 1
          example: X-Some-Header
        value:
          type: string
          minLength: 1
          example: some-token-value
        successUrl:
          type: string
          minLength: 1
          example: 'http://api.example.test:8000/auth/check'
        successString:
          type: string
          minLength: 3
          example: Access granted
    XHRTargetAuthBearer:
      type: object
      description: parameters for bearer authentication
      required:
        - token
        - successUrl
      properties:
        token:
          type: string
          minLength: 1
          example: some-token-value
        successUrl:
          type: string
          minLength: 1
          example: 'http://api.example.test:8000/auth/check'
        successString:
          type: string
          minLength: 3
          example: Access granted
    XHRTargetAuthHTTPBasicInfo:
      type: object
      description: Parameters for HTTP basic authentication
      required:
        - username
      additionalProperties: false
      properties:
        username:
          type: string
          description: Username for HTTP authentication
          minLength: 1
          example: admin
    XHRTargetAuthHTMLAutoFormInfo:
      type: object
      description: Parameters for HTML autoform authentication
      required:
        - username
        - formUrl
        - successString
      additionalProperties: false
      properties:
        username:
          type: string
          minLength: 1
          description: Username for autoform authentication
          example: admin
        formUrl:
          type: string
          minLength: 5
          description: Form location URL
          example: 'https://itsm.example.com/login/'
        successString:
          type: string
          minLength: 3
          description: String on target page to check if target authentication was successful
          example: My profile
    XHRTargetAuthHTMLFormBasedInfo:
      type: object
      description: Parameters for HTML form-based authentication
      required:
        - formUrl
        - formXPath
        - usernameField
        - usernameValue
        - passwordField
        - regexpOfSuccess
      additionalProperties: false
      properties:
        formUrl:
          type: string
          minLength: 5
          description: Form location URL
          example: 'https://itsm.example.com/login/'
        formXPath:
          type: string
          minLength: 1
          description: Form location XPath
          example: './/form'
        usernameField:
          type: string
          minLength: 1
          description: Username form field name for form-based authentication
          example: login
        usernameValue:
          type: string
          minLength: 1
          description: Username for form-based authentication
          example: admin
        passwordField:
          type: string
          minLength: 1
          description: Password form field name for form-based authentication
          example: pass
        regexpOfSuccess:
          type: string
          minLength: 3
          description: Regexp to locate string on target page to check if authentication was successful
          example: 'Welcome to Damn Vulnerable Web Application!'
        submitValue:
          type: string
          minLength: 1
          description: Submit form button value
          example: 'Log in'
    profileCustomParamsScanScopeEnum:
      type: string
      enum:
        - domain
        - folder
        - path
    profileCustomParamsCrawlingTypeEnum:
      type: string
      enum:
        - smart
        - full_crawling_mode
    profileCustomParamsValidation:
      type: array
      items:
        minItems: 0
        type: object
        properties:
          type:
            type: string
            example: wildcard
          value:
            type: string
            example: '*setup.php*'
    profileCustomParamsHeaders:
      type: array
      items:
        minItems: 0
        type: object
        required:
          - name
          - value
        properties:
          name:
            type: string
            example: User-Agent
          value:
            type: string
            example: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36'
    profileCustomParamsProxyEnum:
      type: string
      enum:
        - http
        - https
        - httpNoConnect
        - socks4
        - socks5
        - socks5h
        - transparent
    profileCustomParamsProxyAuth:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          example: user
        password:
          type: string
          example: pass
    profileCustomParamsProxy:
      type: object
      required:
        - type
        - host
        - port
      properties:
        type:
          $ref: '#/components/schemas/profileCustomParamsProxyEnum'
        host:
          type: string
          example: 127.0.0.1
        port:
          type: integer
          format: int16
          minimum: 0
          maximum: 65535
          example: 6712
        auth:
          $ref: '#/components/schemas/profileCustomParamsProxyAuth'
    XHRProfileCustomParams:
      type: object
      description: This object represents a profile custom params info
      properties:
        scanScope:
          $ref: '#/components/schemas/profileCustomParamsScanScopeEnum'
        crawlingType:
          $ref: '#/components/schemas/profileCustomParamsCrawlingTypeEnum'
        blacklist:
          $ref: '#/components/schemas/profileCustomParamsValidation'
        whitelist:
          $ref: '#/components/schemas/profileCustomParamsValidation'
        delayBetweenRequests:
          type: number
          format: float
          minimum: 0
        headers:
          $ref: '#/components/schemas/profileCustomParamsHeaders'
        proxy:
          $ref: '#/components/schemas/profileCustomParamsProxy'
        workers:
          type: integer
          format: int8
          minimum: 1
          maximum: 50
          example: 4
        modules:
          type: array
          items:
            minItems: 0
            type: string
            example: dirscan
        raw:
          type: object
          example: { }
    XHRProfile:
      type: object
      description: This object represents a profile custom params info
      required:
        - uuid
        - name
        - type
        - params
        - group
      properties:
        uuid:
          type: string
        name:
          type: string
        type:
          type: string
        params:
          $ref: '#/components/schemas/XHRProfileCustomParams'
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    XHRAuthProfileInfo:
      type: object
      description: This object represents an auth profile info
      required:
        - name
        - type
        - groupUUID
      properties:
        name:
          type: string
          example: admin
        type:
          $ref: '#/components/schemas/targetAuthenticationTypesEnum'
        httpBasic:
          $ref: '#/components/schemas/XHRTargetAuthHTTPBasicInfo'
        htmlAutoForm:
          $ref: '#/components/schemas/XHRTargetAuthHTMLAutoFormInfo'
        htmlFormBased:
          $ref: '#/components/schemas/XHRTargetAuthHTMLFormBasedInfo'
        rawCookie:
          $ref: '#/components/schemas/XHRTargetAuthRawCookie'
        apiKey:
          $ref: '#/components/schemas/XHRTargetAuthAPIKey'
        bearer:
          $ref: '#/components/schemas/XHRTargetAuthBearer'
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
      nullable: false
    XHRAuthProfileInfoShort:
      type: object
      description: This object represents a short auth profile info
      required:
        - uuid
        - name
        - group
      properties:
        uuid:
          type: string
          example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
        name:
          type: string
          example: admin
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    XHRAuthChainInfo:
      type: object
      description: This object represents an auth chain info
      required:
        - uuid
        - name
        - profiles
        - group
      properties:
        uuid:
          type: string
          example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
        name:
          type: string
          example: admin
        profiles:
          type: array
          items:
            type: string
          example: [ "0d44db80-28fd-4dbc-8a3c-004071225d88", "78631129-2796-4e2b-97fc-b43909f02cd3", "fbf30a04-e549-4ae1-91f5-8f80b8f24eb4" ]
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
      nullable: false
    XHRAuthChainInfoShort:
      type: object
      description: This object represents a short auth chain info
      required:
        - name
        - uuid
        - group
      properties:
        name:
          type: string
          example: admin
        uuid:
          type: string
          example: ca73e0f5-d286-457c-9ec2-deca88a38ecc
        group:
          $ref: '#/components/schemas/XHRGroupShortInfo'
    XHRGroupRoleShortInfo:
      type: object
      description: This object represents a group info with total users count
      required:
        - uuid
        - name
        - type
      properties:
        uuid:
          type: string
          example: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379
        name:
          type: string
          example: devops
        type:
          $ref: '#/components/schemas/groupTypesEnum'
        role:
          $ref: '#/components/schemas/roleNameConstantsEnum'
    XHRGroupRolesList:
      type: object
      description: This object represents a list of group possible roles
      required:
        - roles
      properties:
        roles:
          type: array
          items:
            type: string
            description: List of group roles
          uniqueItems: true
          example:
            - AUDITOR
            - OPERATOR
            - MODERATOR
    XHRGroupCreated:
      type: object
      description: This object represents a short group info
      required:
        - uuid
        - name
      properties:
        uuid:
          type: string
          example: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379
        name:
          type: string
          example: devops
    XHRGroupRoleFullInfo:
      type: object
      description: This object represents detailed group info
      required:
        - uuid
        - name
        - type
        - createdAt
      properties:
        uuid:
          type: string
          example: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379
        name:
          type: string
          example: devops
        type:
          $ref: '#/components/schemas/groupTypesEnum'
        role:
          $ref: '#/components/schemas/roleNameConstantsEnum'
        createdAt:
          type: string
          format: date-time
          description: Datetime of group creation
    XHRRoleInfo:
      type: object
      description: This object represents current user role
      properties:
        name:
          type: string
          nullable: false
          description: Human-readable name of a role
          example: GUEST
        permissions:
          type: array
          items:
            type: string
            description: List of role permissions
          uniqueItems: true
          example:
            - SITE_HISTORY
            - CAN_ADD_SITE
    userRole:
      type: object
      description: User role
      required:
        - uuid
      properties:
        uuid:
          type: string
          example: 0d44db80-28fd-4dbc-8a3c-004071225d88
        role:
          $ref: '#/components/schemas/roleNameConstantsEnum'
    groupUserNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: GROUP_USER_NOT_FOUND
    groupRoleNotFound:
      allOf:
        - $ref: '#/components/schemas/errorResponse'
        - properties:
            ok:
              example: false
            error:
              properties:
                code:
                  example: GROUP_ROLE_NOT_FOUND

security:
  - apiToken: []

servers:
  - url: '{protocol}://bbs.ptsecurity.com/app/api/v1'
    description: PT BlackBox server
    variables:
      protocol:
        enum:
          - http
          - https
        default: https
tags:
  - name: sites (general)
    description: 'CRUD for sites, state management, verification control'
  - name: sites (scans)
    description: scan results and related data
  - name: profiles
    description: set up new profile custom params, change/get/delete profile custom params
  - name: auth profiles
    description: 'Auth profiles endpoints'
  - name: auth chains
    description: 'Auth chains endpoints'
  - name: groups
    description: 'groups management'

paths:
  /sites:
    get:
      summary: Get (general) information about all user sites
      tags:
        - sites (general)
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRSiteShort'
                        nullable: false
  '/sites/{siteUUID}':
    get:
      summary: Get full information about specified site
      tags:
        - sites (general)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRSiteInfo'
                    nullable: false
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/siteNotFound'
  /sites/add:
    post:
      summary: Create new site
      tags:
        - sites (general)
      parameters:
        - $ref: '#/components/parameters/csrfToken'
      requestBody:
        $ref: '#/components/requestBodies/siteInputJSON'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRSiteInfo'
                    nullable: false
        '400':
          description: Bad request
          content:
            application/json:
              schema:
               oneOf:
                 - $ref: '#/components/schemas/urlError'
                 - $ref: '#/components/schemas/siteAuthSettingsNotFound'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/sitePermissionDenied'
                  - $ref: '#/components/schemas/siteLimitExceeded'
                  - $ref: '#/components/schemas/siteExist'
                  - $ref: '#/components/schemas/siteUrlDeniedForAnyScans'
                  - $ref: '#/components/schemas/licenseLimitExceeded'
                  - $ref: '#/components/schemas/licenseInvalid'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/profileNotFound'
                  - $ref: '#/components/schemas/groupNotFound'
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/fetchLicense'
  '/sites/{siteUUID}/settings':
    get:
      summary: Get site settings
      tags:
        - sites (general)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRSiteSettings'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/siteNotFound'
    post:
      summary: Change site settings
      tags:
        - sites (general)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/csrfToken'
      requestBody:
        $ref: '#/components/requestBodies/siteSettingsInputJSON'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRSiteSettings'
        '400':
          description: Specified auth profile was not found
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/urlError'
                  - $ref: '#/components/schemas/siteAuthSettingsNotFound'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/sitePermissionDenied'
                  - $ref: '#/components/schemas/siteExist'
                  - $ref: '#/components/schemas/siteUrlDeniedForAnyScans'
                  - $ref: '#/components/schemas/siteCannotSetUrl'
                  - $ref: '#/components/schemas/siteCannotSetAuth'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/siteNotFound'
                  - $ref: '#/components/schemas/profileNotFound'
  '/sites/{siteUUID}/start':
    post:
      summary: Start scan for specified site
      tags:
        - sites (general)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/csrfToken'
      responses:
        '202':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRScanShort'
                        nullable: false
        '400':
          description: Scan has already been started
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/errorResponse'
                  - properties:
                      ok:
                        example: false
                      error:
                        properties:
                          code:
                            example: SCAN_ALREADY_STARTED
                          description:
                            example: You have already started scan for this site. Click stop and the start to restart the scan.
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/sitePermissionDenied'
                  - $ref: '#/components/schemas/licenseLimitExceeded'
                  - $ref: '#/components/schemas/licenseInvalid'
                  - $ref: '#/components/schemas/siteLimitExceeded'
                  - $ref: '#/components/schemas/scanCreateLastScanProgress'
                  - $ref: '#/components/schemas/scanAuthCheckInProgress'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/fetchLicense'
                  - $ref: '#/components/schemas/scanStartTaskSend'
  '/sites/{siteUUID}/stop':
    post:
      summary: Stop scan for specified site
      tags:
        - sites (general)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/csrfToken'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/baseResponse'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/sitePermissionDenied'
                  - $ref: '#/components/schemas/scanCannotBeStopped'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/fetchLicense'
                  - $ref: '#/components/schemas/scanStopTaskSend'
  '/sites/{siteUUID}/scans/{scanID}':
    get:
      summary: Get detailed information about specified scan
      tags:
        - sites (scans)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/scanID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRScanShort'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/sitePermissionDenied'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
  '/sites/{siteUUID}/scans/{scanID}/vulnerabilities':
    get:
      summary: Get grouped list of vulnerabilities for specified scan. Grouped by vuln's type and its severity.
      tags:
        - sites (scans)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/scanID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRVulnerabilityGroup'
                        nullable: false
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/sitePermissionDenied'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
  '/sites/{siteUUID}/scans/{scanID}/vulnerabilities/{issueTypes}/{groupName}/{severity}':
    get:
      summary: Get all vulns in group
      description: Expand vuln's group. For create request URL use next
        issueType/requestKey/serverity from vulnerabilities endpoint's response
      tags:
        - sites (scans)
      parameters:
        - $ref: '#/components/parameters/paginationLimit'
        - $ref: '#/components/parameters/paginationPage'
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/scanID'
        - $ref: '#/components/parameters/issueTypes'
        - $ref: '#/components/parameters/groupName'
        - $ref: '#/components/parameters/severity'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        allOf:
                          - $ref: '#/components/schemas/XHRPagination'
                          - type: object
                            properties:
                              items:
                                type: array
                                items:
                                  oneOf:
                                  - $ref: '#/components/schemas/XHRVulnerabilityIssueType'
                                  - $ref: '#/components/schemas/XHRVulnerabilityCVEType'
                                  - $ref: '#/components/schemas/XHRVulnerabilityErrorPageType'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/sitePermissionDenied'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
  '/sites/{siteUUID}/scans/{scanID}/shared':
    post:
      summary: 'Create shared link for current scan'
      tags:
        - sites (scans)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/scanID'
      requestBody:
        $ref: '#/components/requestBodies/sharedDataInputJSON'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/SharedLinkCreated'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/sitePermissionDenied'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
    get:
      summary: 'Get shared links for current scan'
      tags:
        - sites (scans)
      parameters:
        - $ref: '#/components/parameters/siteUUID'
        - $ref: '#/components/parameters/scanID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/SharedLinkCreated'
        '404':
          description: Not found
          content:
            application/json:
              schema:
                oneOf:
                 - $ref: '#/components/schemas/siteNotFound'
                 - $ref: '#/components/schemas/scanNotFound'
  /profiles:
    get:
      summary: Get list of available profiles for current user
      tags:
        - profiles
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRProfileShort'
                        nullable: false
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileLoginRequired'
    post:
      summary: 'Create a new profile for current user'
      tags:
        - profiles
      requestBody:
        $ref: '#/components/requestBodies/profileCreateJSON'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/profilesCreated'
        '400':
          description: 'Bad request'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/profileInvalidModules'
                  - $ref: '#/components/schemas/profileInvalidBase'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileLoginRequired'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/groupPermissionDenied'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/groupNotFound'
  /profiles/{profileUUID}:
    get:
      tags:
        - profiles
      summary: 'Get profile description by UUID'
      parameters:
        - $ref: '#/components/parameters/profileUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRProfile'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileNotFound'
    patch:
      tags:
        - profiles
      summary: 'Update profile by UUID'
      parameters:
        - $ref: '#/components/parameters/profileUUID'
      requestBody:
        $ref: '#/components/requestBodies/profileUpdateJSON'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRProfileShort'
        '400':
          description: 'Bad request'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileInvalidModules'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/groupPermissionDenied'
                  - $ref: '#/components/schemas/profileCannotBeModified'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileNotFound'
    delete:
      tags:
        - profiles
      summary: 'Delete profile by UUID'
      parameters:
        - $ref: '#/components/parameters/profileUUID'
      responses:
        '200':
          description: Deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/baseResponse'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileLoginRequired'
        '403':
          description: 'Permission denied'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/groupPermissionDenied'
                  - $ref: '#/components/schemas/profileCannotBeDeleted'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileNotFound'
        '409':
          description: 'Profile is busy'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileIsBusy'

  /profiles/{profileUUID}/clone:
    post:
      tags:
        - profiles
      summary: Clone current scan profile
      parameters:
        - $ref: '#/components/parameters/profileUUID'
      requestBody:
        $ref: '#/components/requestBodies/profileClone'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/profilesCreated'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/groupPermissionDenied'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileNotFound'

  /profiles/modules/list:
    get:
      tags:
        - profiles
      summary: 'Get available profile modules for current user'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          modules:
                            type: array
                            items:
                              type: string
                              example: dirscan
                            nullable: false
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/profileLoginRequired'
  /apiprofiles:
    get:
      summary: Get array of all APIProfiles by user.
      tags:
        - api-profiles
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/apiProfileShortInfo'
                        nullable: false
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileLoginRequired'
    post:
      summary: Create APIProfiles
      tags:
        - api-profiles
      requestBody:
        $ref: '#/components/requestBodies/apiProfileCreate'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/apiProfilesCreated'
        '400':
          description: 'Bad request'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileInvalidSchema'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileLoginRequired'
        '403':
          description: 'Premission denied'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfilePermissionDenied'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/groupNotFound'
        '422':
          description: 'Unprocessable Content'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileInvalidContent'
        '500':
          description: 'Server error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileInvalidEncoder'
  /apiprofiles/{apiprofileUUID}:
    get:
      tags:
        - api-profiles
      summary: Get APIProfile by UUID
      parameters:
        - $ref: '#/components/parameters/apiProfileUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/apiProfile'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileNotFound'
    delete:
      tags:
        - api-profiles
      summary: Delete APIProfile by UUID
      parameters:
        - $ref: '#/components/parameters/apiProfileUUID'
      responses:
        '200':
          description: Deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/baseResponse'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileLoginRequired'
        '403':
          description: 'Premission denied'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfilePermissionDenied'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileNotFound'
        '409':
          description: 'API Profile is used'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileIsUsed'
    patch:
      tags:
        - api-profiles
      summary: Update APIprofile by UUID
      parameters:
        - $ref: '#/components/parameters/apiProfileUUID'
      requestBody:
        $ref: '#/components/requestBodies/apiProfileUpdate'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/apiProfileShortInfo'
        '400':
          description: 'Bad request'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileInvalidSchema'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileLoginRequired'
        '403':
          description: 'Premission denied'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfilePermissionDenied'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileNotFound'
        '422':
          description: 'Unprocessable Content'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileInvalidContent'
        '500':
          description: 'Server error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileInvalidEncoder'
  /apiprofiles/{apiprofileUUID}/clone:
    post:
      tags:
        - api-profiles
      summary: Clone current APIProfile
      parameters:
        - $ref: '#/components/parameters/apiProfileUUID'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/apiProfilesCreated'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileLoginRequired'
        '403':
          description: 'Premission denied'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfilePermissionDenied'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/apiProfileNotFound'

  /authprofiles:
    get:
      summary: Get list of available auth profiles for current user
      tags:
        - auth profiles
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRAuthProfileInfoShort'
                        nullable: false
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileLoginRequired'
    post:
      summary: Create a new auth profile
      tags:
        - auth profiles
      requestBody:
        $ref: '#/components/requestBodies/XHRAuthProfileInput'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthProfileInfoShort'
        '400':
          description: 'Invalid authentication data'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileInvalidAuthentication'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileLoginRequired'
  /authprofiles/{authProfileUUID}:
    get:
      tags:
        - auth profiles
      summary: Get auth profile description by UUID
      parameters:
        - $ref: '#/components/parameters/authProfileUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthProfileInfo'
              examples:
                http_basic:
                  value:
                    name: admin
                    type: HTTP_BASIC
                    httpBasic: {
                      username: admin
                    }
                    group: {
                      uuid: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379,
                      name: devops
                    }
                html_auto_form:
                  value:
                    name: admin
                    type: HTML_AUTO_FORM
                    htmlAutoForm: {
                      username: admin,
                      formUrl: 'https://itsm.example.com/login/',
                      successString: My profile
                    }
                    group: {
                      uuid: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379,
                      name: devops
                    }
                html_form_based:
                  value:
                    name: admin
                    type: HTML_FORM_BASED
                    htmlFormBased: {
                      formUrl: 'https://itsm.example.com/login/',
                      formXPath: .//form,
                      usernameField: login,
                      usernameValue: admin,
                      passwordField: pass,
                      regexpOfSuccess: Welcome to Damn Vulnerable Web Application!,
                      submitValue: Log in
                    }
                    group: {
                      uuid: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379,
                      name: devops
                    }
                raw_cookie:
                  value:
                    name: admin
                    type: RAW_COOKIE
                    rawCookie: {
                      cookies: [ PHPSESSID=bnc3li5jhmebd50suf9a99u0u3; ],
                      successUrl: 'http://mydvwa.ru/vulnerabilities/xss_r/',
                      regexpOfSuccess: Logout
                    }
                    group: {
                      uuid: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379,
                      name: devops
                    }
                api_key:
                  value:
                    name: admin
                    type: API_KEY
                    apiKey: {
                      place: HEADER,
                      name: X-Some-Header,
                      value: some-token-value,
                      successUrl: 'http://api.example.test:8000/auth/check',
                      successString: Access granted
                    }
                    group: {
                      uuid: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379,
                      name: devops
                    }
                bearer:
                  value:
                    name: admin
                    type: BEARER
                    bearer: {
                      token: some-token-value,
                      successUrl: 'http://api.example.test:8000/auth/check',
                      successString: Access granted
                    }
                    group: {
                      uuid: 9dd61f0d-6a3e-4e7b-97fd-8a667a076379,
                      name: devops
                    }
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileNotFound'
    patch:
      tags:
        - auth profiles
      summary: Update auth profile by UUID
      parameters:
        - $ref: '#/components/parameters/authProfileUUID'
      requestBody:
        $ref: '#/components/requestBodies/XHRAuthProfileUpdate'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthProfileInfoShort'
        '400':
          description: 'Invalid authentication data'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileInvalidAuthentication'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileNotFound'
    delete:
      tags:
        - auth profiles
      summary: Delete auth profile by UUID
      parameters:
        - $ref: '#/components/parameters/authProfileUUID'
      responses:
        '200':
          description: Deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/baseResponse'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileNotFound'
        '409':
          description: 'Auth Profile is used'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileIsUsed'

  /authprofiles/{authProfileUUID}/clone:
    post:
      tags:
        - auth profiles
      summary: Clone current auth profile
      parameters:
        - $ref: '#/components/parameters/authProfileUUID'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthProfileInfoShort'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileNotFound'

  /authchains:
    get:
      summary: Get list of available auth chains for current user
      tags:
        - auth chains
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRAuthChainInfoShort'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainLoginRequired'
    post:
      summary: Create a new auth chain for current user
      tags:
        - auth chains
      requestBody:
        $ref: '#/components/requestBodies/XHRAuthChainInput'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthChainInfoShort'
        '400':
          description: 'List of not found requested auth profiles'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainAuthProfilesNotFound'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainLoginRequired'
  /authchains/{authChainUUID}:
    get:
      tags:
        - auth chains
      summary: Get auth chain description by UUID
      parameters:
        - $ref: '#/components/parameters/authChainUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthChainInfo'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainNotFound'
    patch:
      tags:
        - auth chains
      summary: Update auth chain by UUID
      parameters:
        - $ref: '#/components/parameters/authChainUUID'
      requestBody:
        $ref: '#/components/requestBodies/XHRAuthChainUpdate'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthChainInfoShort'
        '400':
          description: 'List of not found requested auth profiles'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainAuthProfilesNotFound'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainNotFound'
    delete:
      tags:
        - auth chains
      summary: Delete auth chain by UUID
      parameters:
        - $ref: '#/components/parameters/authChainUUID'
      responses:
        '200':
          description: Deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/baseResponse'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authProfileLoginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainNotFound'
        '409':
          description: 'Auth Chain is used'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authChainIsUsed'

  /authchains/{authChainUUID}/clone:
    post:
      tags:
        - auth chains
      summary: Clone current auth chain
      parameters:
        - $ref: '#/components/parameters/authChainUUID'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRAuthChainInfoShort'

  /groups:
    get:
      summary: Get list of groups that are available to current user
      tags:
        - groups
      parameters:
        - $ref: '#/components/parameters/filterByName'
        - $ref: '#/components/parameters/filterByRole'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRGroupRoleShortInfo'
        '401':
          description: Login required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginRequired'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/permissionDenied'
    post:
      summary: Create a new user group
      tags:
        - groups
      requestBody:
        $ref: '#/components/requestBodies/groupInput'
      responses:
        '201':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRGroupCreated'
        '400':
          description: Bad input
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/errorResponse'
                  - properties:
                      ok:
                        example: false
                      error:
                        properties:
                          code:
                            example: GROUP_NAME_ALREADY_TAKEN
                          description:
                            example: Group name is already taken
        '401':
          description: Login required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginRequired'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/permissionDenied'
  /groups/{groupUUID}:
    get:
      tags:
        - groups
      summary: Get detailed group info by UUID
      parameters:
        - $ref: '#/components/parameters/groupUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRGroupRoleFullInfo'
        '401':
          description: 'Login required'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginRequired'
        '404':
          description: 'Not found'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/groupNotFound'
  /groups/{groupUUID}/permissions:
    get:
      tags:
        - groups
      summary: Get user's role and permissions for this group
      parameters:
        - $ref: '#/components/parameters/groupUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/XHRRoleInfo'
                  - type: object
                    properties:
                      data:
                        nullable: true
        '404':
          description: In case when user has no direct access to the group
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/groupNotFound'
  /groups/{groupUUID}/users/add:
    post:
      summary: Add users with specified uuids to group with specified uuid
      tags:
        - groups
      requestBody:
        $ref: '#/components/requestBodies/userRoleList'
      parameters:
        - $ref: '#/components/parameters/groupUUID'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/baseResponse'
        '400':
          description: Group role or user not found
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/groupRoleNotFound'
                  - $ref: '#/components/schemas/groupUserNotFound'
        '401':
          description: Login required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginRequired'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/permissionDenied'
  /groups/roles/list:
    get:
      summary: Get list of group roles
      tags:
        - groups
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/baseResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/XHRGroupRolesList'
        '401':
          description: Login required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginRequired'
  /users:
    post:
      summary: Create a new user
      tags:
        - users
      requestBody:
        $ref: '#/components/requestBodies/userInput'
      responses:
        '201':
          description: Successful response
        '400':
          description: Bad input
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/errorResponse'
                  - properties:
                      ok:
                        example: false
                      error:
                        properties:
                          code:
                            example: USER_UUID_ALREADY_TAKEN
                          description:
                            example: User UUID is already taken
        '401':
          description: Login required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/loginRequired'
        '403':
          description: Permission denied
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/permissionDenied'